function mainCtrl($scope){$scope.region=[],$scope.group_size=3,$scope.selected=[],$scope.all_seats=[],$scope.init=function(){var rows=["A","B","C","D","E","F"],num_col=12;$scope.main={id:1,name:"Main Region",rows:[]};var id=1;$.each(rows,function(){var letter=this;$scope.addRow($scope.main,{name:letter,seats:[]});for(var this_row=$scope.main.rows[$scope.main.rows.length-1],i=1;num_col+1>i;i++){var seat={available:"available",name:letter+""+i,pos:i,row:letter,id:id,row_ref:this_row};$scope.addSeat(this_row,seat),$scope.all_seats.push(seat),id++}});for(var i=1;15>i;i++)$scope.randomSeatingUnavailable()},$scope.addRegion=function(r){var region=r||{id:Math.random().toString(36).substring(7),name:"Example Region",rows:[]};$scope.region.push(region)},$scope.addRow=function(region,r){var row=r||{name:"ROW",seats:[]};region.rows.push(row)},$scope.addSeat=function(row,s){var seat=s||{available:"available",name:"ROWTEST"};row.seats.push(seat)},$scope.closestAvailableSeat=function(seat){var row=seat.row_ref,this_index=row.seats.indexOf(seat);if(seat.available){var next_seat=row.seats[this_index+1];if(next_seat&&"available"==next_seat.available)return next_seat;var prev_seat=row.seats[this_index-1];return prev_seat&&"available"==prev_seat.available?prev_seat:!1}return!1},$scope.selectSeat=function(seat){$scope.remaining=$scope.group_size-$scope.selected.length,"available"==seat.available&&$scope.remaining>0?(seat.available="selected",$scope.selected.push(seat)):"selected"==seat.available?(seat.available="available",$scope.selected.pop(seat)):0==$scope.remaining&&($scope.selected[0].available="available",$scope.selected.splice(0,1),seat.available="selected",$scope.selected.push(seat)),$scope.remaining=$scope.group_size-$scope.selected.length},$scope.randomSeatingUnavailable=function(){var random=Math.floor(72*Math.random()+1);$.each($scope.all_seats,function(){this.id==random&&(this.available="unavailable")})},$scope.init()}angular.module("plan",[]).config(function($routeProvider){$routeProvider.when("/",{controller:mainCtrl,template:$("#main").html()})}).directive("tooltip",function(){return{restrict:"AC",link:function(scope,element){$(element).tooltip({placement:"auto"})}}});